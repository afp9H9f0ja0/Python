import pandas as pd

workers = {
    "Петров": "м. Харків, вул. Сумська, 22",
    "Сидоров": "м. Одеса, вул. Дерибасівська, 5",
    "Кузін": "м. Дніпро, вул. Центральна, 11",
    "Куравльов": "м. Львів, вул. Городоцька, 45",
    "Кудін": "м. Чернігів, вул. Шевченка, 7",
    "Кульков": "м. Полтава, вул. Європейська, 9",
    "Кубиків": "м. Суми, вул. Соборна, 3",
    "Гринь": "м. Запоріжжя, вул. Перемоги, 18",
    "Дрон": "м. Вінниця, вул. Київська, 14"
}

df = pd.DataFrame(list(workers.items()), columns=['Прізвище', 'Адреса'])

df['Категорія'] = ['Електроніка', 'Меблі', 'Електроніка', 'Побутова техніка', 
                   'Меблі', 'Електроніка', 'Побутова техніка', 'Меблі', 'Електроніка']
df['Товар'] = ['Ноутбук', 'Стіл', 'Смартфон', 'Холодильник', 
               'Диван', 'Планшет', 'Пральна машина', 'Крісло', 'Монітор']
df['Ціна'] = [25000, 4500, 15000, 12000, 8000, 11000, 10500, 3000, 6000]
df['Кількість'] = [2, 10, 5, 3, 4, 6, 2, 8, 5]

print("--- 1. Вміст сформованого DataFrame ---")
print(df)
print("\n" + "="*50 + "\n")

print("--- 2. Перші 3 рядки (df.head(3)) ---")
print(df.head(3))

print("\n--- 3. Типи даних (df.dtypes) ---")
print(df.dtypes)

print("\n--- 4. Розмірність (df.shape) ---")
rows, cols = df.shape
print(f"Рядків: {rows}, Стовпців: {cols}")

print("\n--- 5. Описова статистика (df.describe()) ---")
print(df.describe())
print("\n" + "="*50 + "\n")

df['Загальна_Вартість'] = df['Ціна'] * df['Кількість']

print("--- 6. DataFrame з новим стовпцем 'Загальна_Вартість' ---")
print(df[['Прізвище', 'Товар', 'Ціна', 'Кількість', 'Загальна_Вартість']])

filtered_df = df[df['Ціна'] > 10000]
print("\n--- 7. Фільтрація (Ціна > 10 000) ---")
print(filtered_df[['Прізвище', 'Товар', 'Ціна']])

sorted_df = df.sort_values(by='Загальна_Вартість', ascending=False)
print("\n--- 8. Сортування (за спаданням суми продажів) ---")
print(sorted_df[['Прізвище', 'Загальна_Вартість']])
print("\n" + "="*50 + "\n")

print("--- 9. Середні показники по категоріях ---")
grouped_mean = df.groupby('Категорія')[['Ціна', 'Кількість', 'Загальна_Вартість']].mean()
print(grouped_mean)

print("\n--- 10. Додаткові агрегації ---")

max_sales = df.groupby('Категорія')['Загальна_Вартість'].max()
print("Максимальна сума продажу в категорії:\n", max_sales)

unique_products = df['Товар'].nunique()
print(f"\nКількість унікальних товарів: {unique_products}")